# Pre-Release - Builds when you create a GitHub prerelease
# Use case: Beta testing with select customers before going stable
# Tags produced: prerelease, prerelease-{version} (e.g., prerelease-v1.0.0-beta.1)
name: Pre-Release

on:
  release:
    types: [prereleased]

permissions:
  contents: read
  packages: write

jobs:
  build:
    uses: ./.github/workflows/service_docker-build-and-publish.yml
    with:
      docker-tags: |
        shpcr.io/selfhostpro/demo:prerelease
        shpcr.io/selfhostpro/demo:prerelease-${{ github.ref_name }}
      dockerfile: "./Dockerfile.php"
      environment: prerelease
      version: "${{ github.ref_name }}"
    secrets: inherit
